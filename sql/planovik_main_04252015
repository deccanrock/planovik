-- MySQL dump 10.13  Distrib 5.6.21, for Win64 (x86_64)
--
-- Host: localhost    Database: planovik_main
-- ------------------------------------------------------
-- Server version	5.6.21-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `isocurrencies`
--

DROP TABLE IF EXISTS `isocurrencies`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `isocurrencies` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `isocode` varchar(3) NOT NULL,
  `currdesc` varchar(20) NOT NULL,
  PRIMARY KEY (`isocode`),
  UNIQUE KEY `id_UNIQUE` (`id`),
  UNIQUE KEY `isocode_UNIQUE` (`isocode`),
  UNIQUE KEY `desc_UNIQUE` (`currdesc`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `isocurrencies`
--

LOCK TABLES `isocurrencies` WRITE;
/*!40000 ALTER TABLE `isocurrencies` DISABLE KEYS */;
INSERT INTO `isocurrencies` VALUES (6,'AED','UAE Dirham'),(7,'AUD','Australian Dollar'),(3,'EUR','Europe Union Euro'),(5,'GBP','Pound Sterling'),(1,'INR','Indian Rupee'),(8,'JPY','Japan Yen'),(13,'KRW','South Korean Won'),(9,'MYR','Malayasian Ringgit'),(14,'NOK','Norwegian Krone'),(10,'NZD','New Zealand Dollar'),(11,'SGD','Singapore Dollar'),(2,'USD','United States Dollar');
/*!40000 ALTER TABLE `isocurrencies` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_activity_codes`
--

DROP TABLE IF EXISTS `itin_activity_codes`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_activity_codes` (
  `code` varchar(10) NOT NULL,
  `description` varchar(40) NOT NULL,
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  PRIMARY KEY (`code`),
  UNIQUE KEY `code_UNIQUE` (`code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_activity_codes`
--

LOCK TABLES `itin_activity_codes` WRITE;
/*!40000 ALTER TABLE `itin_activity_codes` DISABLE KEYS */;
INSERT INTO `itin_activity_codes` VALUES ('T_BOOK','Travel booking only','2015-03-11 03:00:46','2015-03-11 03:00:46'),('T_PIKUPDRP','Pickup and Drop','2015-03-11 02:26:39','2015-03-11 02:26:39');
/*!40000 ALTER TABLE `itin_activity_codes` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_activity_hotel`
--

DROP TABLE IF EXISTS `itin_activity_hotel`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_activity_hotel` (
  `activityid` int(11) NOT NULL AUTO_INCREMENT,
  `itinnum` int(11) NOT NULL,
  `pax` smallint(5) DEFAULT '0',
  `group` smallint(3) DEFAULT '1',
  `code` varchar(8) NOT NULL,
  `version` smallint(2) NOT NULL DEFAULT '0',
  `day` smallint(3) unsigned NOT NULL DEFAULT '0',
  `status` smallint(2) unsigned NOT NULL DEFAULT '1',
  `dateandtime` datetime DEFAULT NULL,
  `propertyname` varchar(15) DEFAULT NULL,
  `city` varchar(15) DEFAULT NULL,
  `roomcat` varchar(15) DEFAULT NULL,
  `price` decimal(10,2) DEFAULT NULL,
  `pricemarkup` smallint(3) unsigned DEFAULT '0',
  `comment` varchar(100) DEFAULT NULL,
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  `name` varchar(45) NOT NULL DEFAULT 'Enter Name',
  `lastupdatedby` int(10) unsigned NOT NULL,
  PRIMARY KEY (`activityid`),
  KEY `fk_code_itin_activity_hotel_idx` (`code`),
  KEY `fk_lastupdateby_itin_activity_hotel_idx` (`lastupdatedby`),
  KEY `fk_itinnum_itin_activity_hotel_idx` (`itinnum`),
  CONSTRAINT `fk_code_itin_activity_hotel` FOREIGN KEY (`code`) REFERENCES `itin_activity_codes` (`code`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_itinnum_itin_activity_hotel` FOREIGN KEY (`itinnum`) REFERENCES `itin_activity_master` (`itinnum`) ON UPDATE CASCADE,
  CONSTRAINT `fk_lastupdateby_itin_activity_hotel` FOREIGN KEY (`lastupdatedby`) REFERENCES `users` (`id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_activity_hotel`
--

LOCK TABLES `itin_activity_hotel` WRITE;
/*!40000 ALTER TABLE `itin_activity_hotel` DISABLE KEYS */;
/*!40000 ALTER TABLE `itin_activity_hotel` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_activity_master`
--

DROP TABLE IF EXISTS `itin_activity_master`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_activity_master` (
  `itinnum` int(11) NOT NULL,
  `version` smallint(2) NOT NULL,
  `pax` smallint(5) NOT NULL,
  `groupnum` smallint(3) NOT NULL DEFAULT '1',
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  `countactivityhotel` smallint(3) unsigned NOT NULL DEFAULT '0',
  `countactivityother` smallint(3) unsigned NOT NULL DEFAULT '0',
  `countactivityrental` smallint(3) unsigned NOT NULL DEFAULT '0',
  `countactivitytravel` smallint(3) unsigned NOT NULL DEFAULT '0',
  `countactivityvisit` smallint(3) NOT NULL DEFAULT '0',
  `lastupdatedby` int(10) unsigned NOT NULL,
  `createdby` int(10) unsigned NOT NULL,
  PRIMARY KEY (`itinnum`),
  KEY `fk_itinum_itini_activity_master_idx` (`itinnum`),
  KEY `fk_lastupdatedby_itin_activity_master_idx` (`lastupdatedby`),
  CONSTRAINT `fk_itinnum_itin_activity_master` FOREIGN KEY (`itinnum`) REFERENCES `itin_master` (`id`) ON UPDATE CASCADE,
  CONSTRAINT `fk_lastupdatedby_itin_activity_master` FOREIGN KEY (`lastupdatedby`) REFERENCES `users` (`id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_activity_master`
--

LOCK TABLES `itin_activity_master` WRITE;
/*!40000 ALTER TABLE `itin_activity_master` DISABLE KEYS */;
INSERT INTO `itin_activity_master` VALUES (1,1,4,1,'2015-04-22 12:54:11','2015-04-24 09:33:55',0,0,0,29,0,6,6);
/*!40000 ALTER TABLE `itin_activity_master` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_activity_master_act`
--

DROP TABLE IF EXISTS `itin_activity_master_act`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_activity_master_act` (
  `itinnum` int(11) NOT NULL,
  `masteractid` smallint(3) NOT NULL DEFAULT '0',
  `masteractname` varchar(45) NOT NULL,
  `masteractstartdate` datetime NOT NULL,
  `masteractenddate` datetime NOT NULL,
  `version` smallint(2) NOT NULL DEFAULT '1',
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  PRIMARY KEY (`itinnum`,`masteractid`),
  CONSTRAINT `fk_itinnum_itin_activity_master_act` FOREIGN KEY (`itinnum`) REFERENCES `itin_activity_master` (`itinnum`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_activity_master_act`
--

LOCK TABLES `itin_activity_master_act` WRITE;
/*!40000 ALTER TABLE `itin_activity_master_act` DISABLE KEYS */;
INSERT INTO `itin_activity_master_act` VALUES (1,0,'Independent Activities','2015-04-29 12:53:00','2015-05-09 12:53:00',1,'2015-04-22 12:54:11','2015-04-22 12:54:11'),(1,1,'Discovering Rajasthan','2015-04-30 06:30:00','2015-05-06 09:26:00',1,'2015-04-24 09:28:05','2015-04-24 09:28:05');
/*!40000 ALTER TABLE `itin_activity_master_act` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_activity_other`
--

DROP TABLE IF EXISTS `itin_activity_other`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_activity_other` (
  `activityid` int(11) NOT NULL AUTO_INCREMENT,
  `itinnum` int(11) NOT NULL,
  `name` varchar(45) NOT NULL DEFAULT 'Enter Name',
  `pax` smallint(5) DEFAULT '0',
  `group` smallint(3) DEFAULT '1',
  `code` varchar(8) DEFAULT NULL,
  `version` smallint(2) NOT NULL DEFAULT '0',
  `day` smallint(3) unsigned NOT NULL DEFAULT '0',
  `status` smallint(2) NOT NULL DEFAULT '1',
  `desc` int(30) DEFAULT NULL,
  `cost` decimal(10,2) DEFAULT NULL,
  `costmarkup` int(3) DEFAULT '0',
  `comment` varchar(30) DEFAULT NULL,
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  `dateandtime` datetime DEFAULT NULL,
  `lastupdatedby` int(10) unsigned NOT NULL,
  PRIMARY KEY (`activityid`),
  UNIQUE KEY `activityid_UNIQUE` (`activityid`),
  KEY `fk_code_itin_activity_other_idx` (`code`),
  KEY `fk_lastupdatedby_itin_acitivity_other_idx` (`lastupdatedby`),
  KEY `fk_itinnum_itin_activity_other_idx` (`itinnum`),
  CONSTRAINT `fk_code_itin_activity_other` FOREIGN KEY (`code`) REFERENCES `itin_activity_codes` (`code`) ON UPDATE CASCADE,
  CONSTRAINT `fk_itinnum_itin_activity_other` FOREIGN KEY (`itinnum`) REFERENCES `itin_activity_master` (`itinnum`) ON UPDATE CASCADE,
  CONSTRAINT `fk_lastupdatedby_itin_acitivity_other` FOREIGN KEY (`lastupdatedby`) REFERENCES `users` (`id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_activity_other`
--

LOCK TABLES `itin_activity_other` WRITE;
/*!40000 ALTER TABLE `itin_activity_other` DISABLE KEYS */;
/*!40000 ALTER TABLE `itin_activity_other` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_activity_rental`
--

DROP TABLE IF EXISTS `itin_activity_rental`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_activity_rental` (
  `activityid` int(11) NOT NULL AUTO_INCREMENT,
  `itinnum` int(11) NOT NULL,
  `name` varchar(45) NOT NULL DEFAULT 'Enter Name',
  `pax` smallint(5) DEFAULT '0',
  `group` smallint(3) DEFAULT '1',
  `code` varchar(8) NOT NULL,
  `day` smallint(3) NOT NULL,
  `vehrentco` varchar(25) DEFAULT NULL,
  `vehrentcontact` varchar(30) DEFAULT NULL,
  `vehrenttype` varchar(15) DEFAULT NULL,
  `vehrentbookingno` varchar(15) DEFAULT NULL,
  `vehrentfromdatetime` datetime DEFAULT NULL,
  `vehrenttodatetime` datetime DEFAULT NULL,
  `vehrentloc` varchar(15) DEFAULT NULL,
  `vehrentcost` decimal(10,2) DEFAULT NULL,
  `vehrentcostmarkup` smallint(3) DEFAULT NULL,
  `status` smallint(5) unsigned NOT NULL DEFAULT '1',
  `comment` varchar(100) DEFAULT NULL,
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  `lastupdatedby` int(11) unsigned NOT NULL,
  `version` smallint(2) NOT NULL DEFAULT '0',
  PRIMARY KEY (`activityid`),
  UNIQUE KEY `activityid_UNIQUE` (`activityid`),
  KEY `fk_code_itin_activity_codes_itin_activity_rental_idx` (`code`),
  KEY `fk_lastupdatedby_itin_activity_rental_idx` (`lastupdatedby`),
  KEY `fk_itinnum_itin_activity_rental_idx` (`itinnum`),
  CONSTRAINT `fk_code_itin_activity_codes_itin_activity_rental` FOREIGN KEY (`code`) REFERENCES `itin_activity_codes` (`code`) ON UPDATE CASCADE,
  CONSTRAINT `fk_itinnum_itin_activity_rental` FOREIGN KEY (`itinnum`) REFERENCES `itin_activity_master` (`itinnum`) ON UPDATE CASCADE,
  CONSTRAINT `fk_lastupdatedby_itin_activity_rental` FOREIGN KEY (`lastupdatedby`) REFERENCES `users` (`id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_activity_rental`
--

LOCK TABLES `itin_activity_rental` WRITE;
/*!40000 ALTER TABLE `itin_activity_rental` DISABLE KEYS */;
/*!40000 ALTER TABLE `itin_activity_rental` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_activity_travel`
--

DROP TABLE IF EXISTS `itin_activity_travel`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_activity_travel` (
  `activityid` int(11) NOT NULL AUTO_INCREMENT,
  `itinnum` int(11) NOT NULL,
  `masteractid` smallint(3) DEFAULT '0',
  `actname` varchar(45) NOT NULL DEFAULT 'Enter Name',
  `pax` smallint(5) DEFAULT '0',
  `mode` smallint(3) DEFAULT '0',
  `groupnum` smallint(3) DEFAULT '1',
  `code` varchar(10) NOT NULL,
  `version` smallint(2) NOT NULL,
  `vesselconame` varchar(20) DEFAULT NULL,
  `vesselno` varchar(15) DEFAULT NULL,
  `bookingclass` varchar(10) DEFAULT NULL,
  `bookingno` varchar(10) DEFAULT NULL,
  `depdatetime` datetime DEFAULT NULL,
  `arrdatetime` datetime DEFAULT NULL,
  `depstation` varchar(15) DEFAULT NULL,
  `arrstation` varchar(15) DEFAULT NULL,
  `cost` decimal(10,2) DEFAULT '0.00',
  `costmarkup` smallint(3) DEFAULT '0',
  `pikupdroplocfrom` varchar(30) DEFAULT NULL,
  `pikupdroplocto` varchar(30) DEFAULT NULL,
  `pikupdropdatetime` datetime DEFAULT NULL,
  `pikupdropcost` decimal(10,2) DEFAULT '0.00',
  `pikupdropcostmarkup` smallint(3) DEFAULT '0',
  `vehdetails` varchar(45) DEFAULT 'none',
  `asstcost` decimal(10,2) DEFAULT '0.00',
  `asstcostmarkup` smallint(3) DEFAULT '0',
  `commentsinternal` varchar(100) DEFAULT NULL,
  `commentsexternal` varchar(100) DEFAULT NULL,
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  `lastupdatedby` int(10) unsigned NOT NULL,
  `createdby` int(10) unsigned NOT NULL,
  PRIMARY KEY (`activityid`,`itinnum`),
  UNIQUE KEY `activityid_UNIQUE` (`activityid`),
  KEY `fk_code_itin_activity_codes_itin_activity_travel` (`code`),
  KEY `fk_lastupdatedby_itin_activity_travel_idx` (`lastupdatedby`),
  KEY `fk_itinnummasteractid_itin_activity_travel_idx` (`itinnum`,`masteractid`),
  CONSTRAINT `fk_code_itin_activity_codes_itin_activity_travel` FOREIGN KEY (`code`) REFERENCES `itin_activity_codes` (`code`) ON UPDATE CASCADE,
  CONSTRAINT `fk_itinnum_itin_activity_travel` FOREIGN KEY (`itinnum`) REFERENCES `itin_activity_master` (`itinnum`) ON UPDATE CASCADE,
  CONSTRAINT `fk_itinnummasteractid_itin_activity_master_act` FOREIGN KEY (`itinnum`, `masteractid`) REFERENCES `itin_activity_master_act` (`itinnum`, `masteractid`) ON UPDATE CASCADE,
  CONSTRAINT `fk_lastupdatedby_itin_activity_travel` FOREIGN KEY (`lastupdatedby`) REFERENCES `users` (`id`) ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_activity_travel`
--

LOCK TABLES `itin_activity_travel` WRITE;
/*!40000 ALTER TABLE `itin_activity_travel` DISABLE KEYS */;
INSERT INTO `itin_activity_travel` VALUES (1,1,0,'Airport Pickup',4,0,1,'T_PIKUPDRP',1,'British Airways','BA 007','','','1970-01-01 00:00:00','1970-01-01 00:00:00','','',0.00,0,'IGIA','Taj Palace','2015-04-29 14:30:00',2500.00,20,'Innova Delhi Travels',1000.00,10,'Car should be clean',NULL,'2015-04-23 10:30:14','2015-04-24 09:29:08',6,6),(3,1,0,'Flight to Jaipur',4,0,1,'T_BOOK',1,'','6E 187','','H3BG4','2015-04-30 06:30:00','2015-04-30 08:00:00','Delhi','Jaipur',10000.00,10,'','','2015-04-29 18:30:00',0.00,0,'',0.00,0,'',NULL,'2015-04-24 09:31:32','2015-04-24 09:31:32',6,6),(4,1,0,'Flight to Delhi',4,0,1,'T_BOOK',1,'','6E 188','','H3CG4','2015-05-06 07:30:00','2015-05-06 09:00:00','Jaipur','Delhi',10000.00,10,'','','1970-01-01 00:00:00',0.00,0,'',0.00,0,'',NULL,'2015-04-24 09:33:55','2015-04-24 09:33:55',6,6);
/*!40000 ALTER TABLE `itin_activity_travel` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_activity_visit`
--

DROP TABLE IF EXISTS `itin_activity_visit`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_activity_visit` (
  `activityid` int(11) NOT NULL AUTO_INCREMENT,
  `itinnum` int(11) NOT NULL,
  `name` varchar(45) NOT NULL DEFAULT 'Enter Name',
  `pax` smallint(5) DEFAULT '0',
  `group` smallint(3) DEFAULT '1',
  `code` varchar(8) NOT NULL,
  `version` smallint(2) NOT NULL DEFAULT '0',
  `day` smallint(3) DEFAULT NULL,
  `placename` varchar(20) DEFAULT NULL,
  `city` varchar(15) DEFAULT NULL,
  `guidename` varchar(20) DEFAULT NULL,
  `guiderate` decimal(10,2) DEFAULT NULL,
  `guideratemarkup` smallint(3) unsigned DEFAULT '0',
  `entrancefees` decimal(10,2) DEFAULT NULL,
  `entrancefeesmarkup` smallint(3) unsigned DEFAULT '0',
  `escortreq` smallint(1) DEFAULT '0',
  `escortfeesmarkup` smallint(3) unsigned DEFAULT NULL,
  `comment` varchar(30) DEFAULT NULL,
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  `escortfees` decimal(10,2) DEFAULT NULL,
  `status` smallint(2) unsigned NOT NULL DEFAULT '1',
  `dateandtime` datetime DEFAULT NULL,
  `lastupdatedby` int(11) unsigned NOT NULL,
  PRIMARY KEY (`activityid`),
  UNIQUE KEY `activityid_UNIQUE` (`activityid`),
  KEY `fk_code_itin_activity_sightseeing_idx` (`code`),
  KEY `fk_lastupdatedby_itin_activity_sightseeing_idx` (`lastupdatedby`),
  KEY `fk_itinnum_itin_activity_visit_idx` (`itinnum`),
  CONSTRAINT `fk_code_itin_activity_sightseeing` FOREIGN KEY (`code`) REFERENCES `itin_activity_codes` (`code`) ON UPDATE CASCADE,
  CONSTRAINT `fk_itinnum_itin_activity_visit` FOREIGN KEY (`itinnum`) REFERENCES `itin_activity_master` (`itinnum`) ON UPDATE CASCADE,
  CONSTRAINT `fk_lastupdatedby_itin_activity_sightseeing` FOREIGN KEY (`lastupdatedby`) REFERENCES `users` (`id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_activity_visit`
--

LOCK TABLES `itin_activity_visit` WRITE;
/*!40000 ALTER TABLE `itin_activity_visit` DISABLE KEYS */;
/*!40000 ALTER TABLE `itin_activity_visit` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_currconv`
--

DROP TABLE IF EXISTS `itin_currconv`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_currconv` (
  `convcode` int(11) NOT NULL AUTO_INCREMENT,
  `fromcurr` varchar(3) NOT NULL,
  `tocurr` varchar(3) NOT NULL,
  `status` smallint(2) NOT NULL DEFAULT '0',
  `unitrate` float NOT NULL,
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`convcode`),
  UNIQUE KEY `conv_code_UNIQUE` (`convcode`),
  UNIQUE KEY `unq_fromcurrtocurrunitrate` (`fromcurr`,`tocurr`,`unitrate`),
  KEY `fk_fromcurr_itin_currconv_idx` (`fromcurr`),
  KEY `fk_tocurr_itin_currconv_idx` (`tocurr`),
  CONSTRAINT `fk_fromcurr_itin_currconv` FOREIGN KEY (`fromcurr`) REFERENCES `isocurrencies` (`isocode`) ON UPDATE CASCADE,
  CONSTRAINT `fk_tocurr_itin_currconv` FOREIGN KEY (`tocurr`) REFERENCES `isocurrencies` (`isocode`) ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_currconv`
--

LOCK TABLES `itin_currconv` WRITE;
/*!40000 ALTER TABLE `itin_currconv` DISABLE KEYS */;
INSERT INTO `itin_currconv` VALUES (1,'INR','INR',1,1,'2015-02-16 11:57:05','2015-02-16 11:57:05'),(2,'USD','INR',1,58,'2015-02-16 06:30:37','2015-02-16 06:30:37'),(3,'USD','INR',1,59,'2015-02-16 06:35:42','2015-02-16 06:35:42'),(4,'USD','INR',1,60,'2015-02-16 06:36:20','2015-02-16 06:36:20'),(5,'USD','INR',1,57,'2015-03-09 13:59:02','2015-03-09 13:59:02'),(6,'USD','INR',1,56,'2015-03-25 10:48:06','2015-03-25 10:48:06');
/*!40000 ALTER TABLE `itin_currconv` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_master`
--

DROP TABLE IF EXISTS `itin_master`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_master` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `version` smallint(2) NOT NULL,
  `status` smallint(2) NOT NULL DEFAULT '0',
  `touroperator` varchar(30) NOT NULL DEFAULT 'Direct Query',
  `grouphead` varchar(30) NOT NULL DEFAULT 'Fill',
  `numtravellers` smallint(6) NOT NULL DEFAULT '0',
  `startdate` datetime DEFAULT NULL,
  `enddate` datetime DEFAULT NULL,
  `arrivalcity` varchar(30) NOT NULL DEFAULT 'Fill',
  `depcity` varchar(30) NOT NULL DEFAULT 'Fill',
  `currency` varchar(3) NOT NULL DEFAULT 'INR',
  `quotecurrency` varchar(3) DEFAULT 'INR',
  `convcode` int(11) DEFAULT '1',
  `tzoffset` smallint(6) NOT NULL DEFAULT '-330',
  `datecreated` datetime NOT NULL,
  `createdby` int(10) unsigned NOT NULL,
  `dateupdated` datetime NOT NULL,
  `lastupdatedby` int(10) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name_UNIQUE` (`name`),
  UNIQUE KEY `id_UNIQUE` (`id`),
  KEY `fk_convcode_itin_currencies_idx` (`convcode`),
  KEY `fk_createdby_itin_master_idx` (`createdby`),
  KEY `fk_lastupdatedby_itin_master_idx` (`lastupdatedby`),
  KEY `fk_currency_idx` (`currency`),
  KEY `fk_quotecurrency_idx` (`quotecurrency`),
  CONSTRAINT `fk_convcode_itin_master` FOREIGN KEY (`convcode`) REFERENCES `itin_currconv` (`convcode`) ON UPDATE CASCADE,
  CONSTRAINT `fk_currency` FOREIGN KEY (`currency`) REFERENCES `isocurrencies` (`isocode`) ON UPDATE CASCADE,
  CONSTRAINT `fk_quotecurrency` FOREIGN KEY (`quotecurrency`) REFERENCES `isocurrencies` (`isocode`) ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_master`
--

LOCK TABLES `itin_master` WRITE;
/*!40000 ALTER TABLE `itin_master` DISABLE KEYS */;
INSERT INTO `itin_master` VALUES (1,'Adam family visit to India',1,1,'Direct Query','Adam Nash',4,'2015-04-29 12:53:00','2015-05-09 12:53:00','Delhi','Delhi','INR','USD',5,-330,'2015-04-22 12:53:27',6,'2015-04-22 12:57:00',6);
/*!40000 ALTER TABLE `itin_master` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `itin_pax_info`
--

DROP TABLE IF EXISTS `itin_pax_info`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `itin_pax_info` (
  `itinnum` int(11) NOT NULL,
  `groupnum` smallint(3) DEFAULT '1',
  `name` varchar(45) NOT NULL,
  `age` smallint(6) DEFAULT NULL,
  `nationality` varchar(45) DEFAULT NULL,
  `passportdet` varchar(60) DEFAULT NULL,
  `visadet` varchar(60) DEFAULT NULL,
  `grouphead` int(1) DEFAULT '0',
  `contactemail` varchar(120) DEFAULT NULL,
  `contactphonell` varchar(15) DEFAULT NULL,
  `contactphonemobile` varchar(15) DEFAULT NULL,
  `contactaddress` varchar(120) DEFAULT NULL,
  `comments` varchar(45) DEFAULT NULL,
  `disability` varchar(15) DEFAULT NULL,
  `languages` varchar(45) DEFAULT 'English',
  `datecreated` datetime DEFAULT NULL,
  `dateupdated` datetime DEFAULT NULL,
  PRIMARY KEY (`itinnum`),
  KEY `fk_itinnum_itin_pax_info_idx` (`itinnum`),
  CONSTRAINT `fk_itinum_itin_pax_info` FOREIGN KEY (`itinnum`) REFERENCES `itin_master` (`id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `itin_pax_info`
--

LOCK TABLES `itin_pax_info` WRITE;
/*!40000 ALTER TABLE `itin_pax_info` DISABLE KEYS */;
/*!40000 ALTER TABLE `itin_pax_info` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_admin_tasks`
--

DROP TABLE IF EXISTS `plnvk_admin_tasks`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_admin_tasks` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `subid` int(5) NOT NULL DEFAULT '0',
  `orgid` varchar(15) NOT NULL,
  `code` int(6) NOT NULL DEFAULT '0',
  `assignedto` int(10) unsigned NOT NULL DEFAULT '0',
  `status` int(2) NOT NULL DEFAULT '0',
  `remarks` varchar(45) DEFAULT NULL,
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `id_UNIQUE` (`id`),
  UNIQUE KEY `unq_id_subid` (`id`,`subid`),
  KEY `fk_assigned_to_idx` (`assignedto`),
  CONSTRAINT `fk_assigned_to` FOREIGN KEY (`assignedto`) REFERENCES `users` (`id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_admin_tasks`
--

LOCK TABLES `plnvk_admin_tasks` WRITE;
/*!40000 ALTER TABLE `plnvk_admin_tasks` DISABLE KEYS */;
/*!40000 ALTER TABLE `plnvk_admin_tasks` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_db_replication`
--

DROP TABLE IF EXISTS `plnvk_db_replication`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_db_replication` (
  `masterid` int(11) NOT NULL,
  `slave1id` int(11) NOT NULL,
  `slave2id` int(11) NOT NULL,
  PRIMARY KEY (`masterid`),
  UNIQUE KEY `masterid_UNIQUE` (`masterid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_db_replication`
--

LOCK TABLES `plnvk_db_replication` WRITE;
/*!40000 ALTER TABLE `plnvk_db_replication` DISABLE KEYS */;
INSERT INTO `plnvk_db_replication` VALUES (1,2,3);
/*!40000 ALTER TABLE `plnvk_db_replication` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_0`
--

DROP TABLE IF EXISTS `plnvk_org_0`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_0` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org0_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_0`
--

LOCK TABLES `plnvk_org_0` WRITE;
/*!40000 ALTER TABLE `plnvk_org_0` DISABLE KEYS */;
INSERT INTO `plnvk_org_0` VALUES ('01-001-00000010','Tata Institute of Fundamental Research',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','fname lname','0123456727','0123456727','fname.lname@tifr.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,-330,'2014-12-18 13:07:34','2014-12-18 13:07:34');
/*!40000 ALTER TABLE `plnvk_org_0` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_1`
--

DROP TABLE IF EXISTS `plnvk_org_1`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_1` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutdate` datetime NOT NULL DEFAULT '0001-01-01 00:00:00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org1_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_1`
--

LOCK TABLES `plnvk_org_1` WRITE;
/*!40000 ALTER TABLE `plnvk_org_1` DISABLE KEYS */;
INSERT INTO `plnvk_org_1` VALUES ('01-001-00000001','B.M.S. College of Engineering',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','Srinivas Paruchuri','9866277000','9866277000','sriniv@yahoo.com','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 12:51:42','2014-12-18 12:51:42'),('01-001-00000011','Tata Institute of Social Sciences',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','fname lname','0123456728','0123456728','fname.lname@tiss.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 13:07:54','2014-12-18 13:07:54');
/*!40000 ALTER TABLE `plnvk_org_1` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_2`
--

DROP TABLE IF EXISTS `plnvk_org_2`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_2` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutdate` datetime NOT NULL DEFAULT '0001-01-01 00:00:00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org2_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_2`
--

LOCK TABLES `plnvk_org_2` WRITE;
/*!40000 ALTER TABLE `plnvk_org_2` DISABLE KEYS */;
INSERT INTO `plnvk_org_2` VALUES ('01-001-00000002','Rabindranath Tagore Medical College',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','Rakhee Paruchuri','9966271222','9966271222','rakheekumar@gmail.com','Asst Professor','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 12:57:57','2014-12-18 12:57:57'),('01-001-00000012','AIIMS, New Delhi',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','Anu Kapoor','0123456729','0123456729','anu.kapoor@aiims.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 20:43:53','2014-12-18 20:43:53');
/*!40000 ALTER TABLE `plnvk_org_2` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_3`
--

DROP TABLE IF EXISTS `plnvk_org_3`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_3` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutdate` datetime NOT NULL DEFAULT '0001-01-01 00:00:00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org3_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_3`
--

LOCK TABLES `plnvk_org_3` WRITE;
/*!40000 ALTER TABLE `plnvk_org_3` DISABLE KEYS */;
INSERT INTO `plnvk_org_3` VALUES ('01-001-00000003','Indian Institute of Technology Bombay',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','fname lname','0123456723','0123456723','fname.lname@iitb.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 12:58:35','2014-12-18 12:58:35'),('01-001-00000013','Maulana Azad Medical College',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','Anu Kapoor','0123456729','0123456729','anu.kapoor@aiims.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 20:45:46','2014-12-18 20:45:46');
/*!40000 ALTER TABLE `plnvk_org_3` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_4`
--

DROP TABLE IF EXISTS `plnvk_org_4`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_4` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutdate` datetime NOT NULL DEFAULT '0001-01-01 00:00:00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org4_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_4`
--

LOCK TABLES `plnvk_org_4` WRITE;
/*!40000 ALTER TABLE `plnvk_org_4` DISABLE KEYS */;
INSERT INTO `plnvk_org_4` VALUES ('01-001-00000004','International Institute of Information Technology, Hyderabad',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','fname lname','0123456723','0123456723','fname.lname@iiitb.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 13:01:16','2014-12-18 13:01:16'),('01-001-00000014','National Institute of Mental Health and Neurosciences',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','Vasu Gowda','0123456730','0123456730','vasu.gowda@nimhans.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 20:47:10','2014-12-18 20:47:10');
/*!40000 ALTER TABLE `plnvk_org_4` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_5`
--

DROP TABLE IF EXISTS `plnvk_org_5`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_5` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutdate` datetime NOT NULL DEFAULT '0001-01-01 00:00:00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org5_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_5`
--

LOCK TABLES `plnvk_org_5` WRITE;
/*!40000 ALTER TABLE `plnvk_org_5` DISABLE KEYS */;
INSERT INTO `plnvk_org_5` VALUES ('01-001-00000005','Lovely Professional University',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','fname lname','0123456723','0123456723','fname.lname@lpu.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 13:02:19','2014-12-18 13:02:19');
/*!40000 ALTER TABLE `plnvk_org_5` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_6`
--

DROP TABLE IF EXISTS `plnvk_org_6`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_6` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutdate` datetime NOT NULL DEFAULT '0001-01-01 00:00:00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org6_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_6`
--

LOCK TABLES `plnvk_org_6` WRITE;
/*!40000 ALTER TABLE `plnvk_org_6` DISABLE KEYS */;
INSERT INTO `plnvk_org_6` VALUES ('01-001-00000006','Manipal Institute of Technology',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','fname lname','0123456723','0123456723','fname.lname@manipal.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 13:02:42','2014-12-18 13:02:42');
/*!40000 ALTER TABLE `plnvk_org_6` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_7`
--

DROP TABLE IF EXISTS `plnvk_org_7`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_7` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutdate` datetime NOT NULL DEFAULT '0001-01-01 00:00:00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org7_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_7`
--

LOCK TABLES `plnvk_org_7` WRITE;
/*!40000 ALTER TABLE `plnvk_org_7` DISABLE KEYS */;
INSERT INTO `plnvk_org_7` VALUES ('01-001-00000007','Vivekananda Educational Society',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','fname lname','0123456724','0123456724','fname.lname@vivekananda.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 13:05:05','2014-12-18 13:05:05');
/*!40000 ALTER TABLE `plnvk_org_7` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_8`
--

DROP TABLE IF EXISTS `plnvk_org_8`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_8` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutdate` datetime NOT NULL DEFAULT '0001-01-01 00:00:00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org8_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_8`
--

LOCK TABLES `plnvk_org_8` WRITE;
/*!40000 ALTER TABLE `plnvk_org_8` DISABLE KEYS */;
INSERT INTO `plnvk_org_8` VALUES ('01-001-00000008','Birla Institute of Technology and Science',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','fname lname','0123456725','0123456725','fname.lname@BITS.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 13:05:41','2014-12-18 13:05:41');
/*!40000 ALTER TABLE `plnvk_org_8` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_9`
--

DROP TABLE IF EXISTS `plnvk_org_9`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_9` (
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  `shortname` varchar(10) DEFAULT NULL,
  `ip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `regcode` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `regcodeissuingauthority` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `isocountrycode` varchar(3) NOT NULL DEFAULT 'IN',
  `logosealloc` varchar(200) NOT NULL DEFAULT 'To be Generated',
  `addrstreet1` varchar(100) NOT NULL DEFAULT 'To be  Filled',
  `addrstreet2` varchar(100) DEFAULT 'NA',
  `addrcitytown` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `addrdistrict` varchar(60) DEFAULT 'NA',
  `addrstateprovrgn` varchar(80) NOT NULL DEFAULT 'To be Filled',
  `addrpostalcode` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `addrhomeurl` varchar(120) NOT NULL DEFAULT 'To be Filled',
  `contacttitle` varchar(10) NOT NULL DEFAULT 'Mr',
  `contactname` varchar(60) NOT NULL DEFAULT 'To be Filled',
  `contactphoneoffice` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactphonemobile` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `contactemail` varchar(100) NOT NULL DEFAULT 'To be Filled',
  `contactdesignation` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `contactip` varchar(45) NOT NULL DEFAULT '127.0.0.1',
  `type` varchar(20) NOT NULL DEFAULT 'To be Filled',
  `subtype` varchar(45) NOT NULL DEFAULT 'To be Filled',
  `status` varchar(15) NOT NULL DEFAULT 'Pending',
  `vrfreqcnt` int(10) unsigned NOT NULL DEFAULT '0',
  `vrfproccnt` int(10) unsigned NOT NULL DEFAULT '0',
  `alrtpendingcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `msgsunrdcnt` int(5) unsigned NOT NULL DEFAULT '0',
  `accntbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutbal` decimal(10,2) NOT NULL DEFAULT '0.00',
  `payoutdate` datetime NOT NULL DEFAULT '0001-01-01 00:00:00',
  `tzoffset` smallint(6) NOT NULL DEFAULT '0',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`orgid`),
  UNIQUE KEY `idx_vrf_org9_name_unq` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Base table to hold an Organization detailed information';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_9`
--

LOCK TABLES `plnvk_org_9` WRITE;
/*!40000 ALTER TABLE `plnvk_org_9` DISABLE KEYS */;
INSERT INTO `plnvk_org_9` VALUES ('01-001-00000009','Reliance School and Gymnasium',NULL,'127.0.0.1','To be Filled','To be Filled','IN','To be Generated','To be  Filled','NA','To be Filled','NA','To be Filled','To be Filled','To be Filled','Mr','fname lname','0123456726','0123456726','fname.lname@reliance.in','Registrar','127.0.0.1','To be Filled','To be Filled','Pending',0,0,0,0,0.00,0.00,'0001-01-01 00:00:00',-330,'2014-12-18 13:07:04','2014-12-18 13:07:04');
/*!40000 ALTER TABLE `plnvk_org_9` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_org_seq`
--

DROP TABLE IF EXISTS `plnvk_org_seq`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_org_seq` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `orgid` varchar(15) NOT NULL,
  `name` varchar(120) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `idx_fk_orgid` (`orgid`),
  KEY `idx_fk_name` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8 COMMENT='Id sequence generator';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_org_seq`
--

LOCK TABLES `plnvk_org_seq` WRITE;
/*!40000 ALTER TABLE `plnvk_org_seq` DISABLE KEYS */;
INSERT INTO `plnvk_org_seq` VALUES (1,'01-001-00000001','B.M.S. College of Engineering'),(2,'01-001-00000002','Rabindranath Tagore Medical College'),(3,'01-001-00000003','Indian Institute of Technology Bombay'),(4,'01-001-00000004','International Institute of Information Technology, Hyderabad'),(5,'01-001-00000005','Lovely Professional University'),(6,'01-001-00000006','Manipal Institute of Technology'),(7,'01-001-00000007','Vivekananda Educational Society'),(8,'01-001-00000008','Birla Institute of Technology and Science'),(9,'01-001-00000009','Reliance School and Gymnasium'),(10,'01-001-00000010','Tata Institute of Fundamental Research'),(11,'01-001-00000011','Tata Institute of Social Sciences'),(12,'01-001-00000012','AIIMS, New Delhi'),(13,'01-001-00000013','Maulana Azad Medical College'),(14,'01-001-00000014','National Institute of Mental Health and Neurosciences');
/*!40000 ALTER TABLE `plnvk_org_seq` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_tenant_master`
--

DROP TABLE IF EXISTS `plnvk_tenant_master`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_tenant_master` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `type` smallint(6) NOT NULL DEFAULT '0',
  `status` smallint(6) NOT NULL,
  `subscription` varchar(20) NOT NULL DEFAULT 'Trial',
  `domainname` varchar(20) NOT NULL,
  `dsurl` varchar(80) NOT NULL,
  `dsusername` varchar(40) NOT NULL,
  `dspassword` varchar(20) NOT NULL,
  `bkdsurl` varchar(80) NOT NULL DEFAULT 'NA',
  `bkdsusername` varchar(40) NOT NULL DEFAULT 'NA',
  `bkdspassword` varchar(20) NOT NULL DEFAULT 'NA',
  `datecreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `dateupdated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `domainname_UNIQUE` (`domainname`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_tenant_master`
--

LOCK TABLES `plnvk_tenant_master` WRITE;
/*!40000 ALTER TABLE `plnvk_tenant_master` DISABLE KEYS */;
INSERT INTO `plnvk_tenant_master` VALUES (1,0,0,'Professional','du','jdbc:mysql://localhost:3306/planovik_silver_1','root','root','NA','NA','NA','2015-01-18 09:46:04','2015-01-18 09:46:04');
/*!40000 ALTER TABLE `plnvk_tenant_master` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `plnvk_zone_db_map`
--

DROP TABLE IF EXISTS `plnvk_zone_db_map`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `plnvk_zone_db_map` (
  `zoneid` int(11) NOT NULL DEFAULT '1',
  `dbid` int(11) NOT NULL DEFAULT '1',
  PRIMARY KEY (`zoneid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `plnvk_zone_db_map`
--

LOCK TABLES `plnvk_zone_db_map` WRITE;
/*!40000 ALTER TABLE `plnvk_zone_db_map` DISABLE KEYS */;
INSERT INTO `plnvk_zone_db_map` VALUES (1,1);
/*!40000 ALTER TABLE `plnvk_zone_db_map` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user_login_attempts`
--

DROP TABLE IF EXISTS `user_login_attempts`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `user_login_attempts` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(30) NOT NULL,
  `attempts` int(2) NOT NULL,
  `lastModified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `fk_username_user_login_attempts_idx` (`username`),
  CONSTRAINT `fk_username_user_login_attempts` FOREIGN KEY (`username`) REFERENCES `users` (`username`) ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user_login_attempts`
--

LOCK TABLES `user_login_attempts` WRITE;
/*!40000 ALTER TABLE `user_login_attempts` DISABLE KEYS */;
INSERT INTO `user_login_attempts` VALUES (5,'ashu',0,'2015-03-08 19:55:36'),(8,'srini',0,'2015-04-22 13:04:26'),(9,'rakhee',0,'2015-03-09 19:25:33');
/*!40000 ALTER TABLE `user_login_attempts` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user_roles`
--

DROP TABLE IF EXISTS `user_roles`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `user_roles` (
  `roleid` int(5) unsigned NOT NULL AUTO_INCREMENT,
  `role` varchar(25) NOT NULL,
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  PRIMARY KEY (`roleid`),
  UNIQUE KEY `unq_username_role` (`role`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user_roles`
--

LOCK TABLES `user_roles` WRITE;
/*!40000 ALTER TABLE `user_roles` DISABLE KEYS */;
INSERT INTO `user_roles` VALUES (1,'ROLE_USER','2015-03-01 05:43:27','2015-03-01 05:43:27'),(2,'ROLE_ADMIN','2015-03-01 05:43:39','2015-03-01 05:43:39'),(3,'ROLE_SUPERADMIN','2015-03-01 05:43:47','2015-03-01 05:43:47');
/*!40000 ALTER TABLE `user_roles` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user_roles_map`
--

DROP TABLE IF EXISTS `user_roles_map`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `user_roles_map` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `username` varchar(30) NOT NULL,
  `role` varchar(25) NOT NULL,
  `datecreated` datetime NOT NULL,
  `dateupdated` datetime NOT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_username_user_roles_map_idx` (`username`),
  KEY `fk_role_user_roles_map_idx` (`role`),
  CONSTRAINT `fk_role_user_roles_map` FOREIGN KEY (`role`) REFERENCES `user_roles` (`role`) ON UPDATE CASCADE,
  CONSTRAINT `fk_username_user_roles_map` FOREIGN KEY (`username`) REFERENCES `users` (`username`) ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user_roles_map`
--

LOCK TABLES `user_roles_map` WRITE;
/*!40000 ALTER TABLE `user_roles_map` DISABLE KEYS */;
INSERT INTO `user_roles_map` VALUES (2,'ashu','ROLE_SUPERADMIN','2015-03-01 06:34:49','2015-03-01 06:34:49'),(3,'srini','ROLE_USER','2015-03-08 13:32:09','2015-03-08 13:32:09'),(4,'rakhee','ROLE_USER','2015-03-09 13:54:19','2015-03-09 13:54:19');
/*!40000 ALTER TABLE `user_roles_map` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `users`
--

DROP TABLE IF EXISTS `users`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `users` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `email` varchar(120) NOT NULL,
  `fullname` varchar(60) NOT NULL,
  `username` varchar(30) NOT NULL,
  `password` varchar(60) NOT NULL,
  `phone` varchar(20) DEFAULT NULL,
  `designation` varchar(20) DEFAULT NULL,
  `reportsto` int(10) NOT NULL DEFAULT '1',
  `createdby` int(10) NOT NULL DEFAULT '1',
  `level` int(3) NOT NULL DEFAULT '0',
  `enabled` tinyint(1) NOT NULL DEFAULT '1',
  `accountNonExpired` tinyint(1) NOT NULL DEFAULT '1',
  `accountNonLocked` tinyint(1) NOT NULL DEFAULT '1',
  `credentialsNonExpired` tinyint(1) NOT NULL DEFAULT '1',
  `tzoffset` int(6) DEFAULT NULL,
  `date_created` datetime NOT NULL,
  `date_updated` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `unq_username_email` (`email`,`username`),
  KEY `IDX_username` (`username`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `users`
--

LOCK TABLES `users` WRITE;
/*!40000 ALTER TABLE `users` DISABLE KEYS */;
INSERT INTO `users` VALUES (1,'ashumalik@gmail.com','Ashutosh Malik','ashu','$2a$10$dBDRjC2GrwV56rJICdc.zuC2VbsZoogzuMSh54KJXlERUFj1RcxNe','0123456789','CEO',1,1,5,1,1,1,1,-330,'2015-02-25 13:31:58','2015-03-08 14:30:49'),(6,'sriniv@yahoo.com','Srinivas Paruchuri','srini','$2a$10$H5jj69EFLRyruhrtiMpvZePHj5BXlY3pMansGX77wIVZRKDL/eqki','0123456782','CTO',1,1,0,1,1,1,1,-330,'2015-03-01 08:28:52','2015-03-09 12:24:37'),(7,'rakheekumar@gmail.com','Rakhee Paruchuri','rakhee','$2a$10$7CgDk5omwqZdRwzhldBosus/pSdQbpKNF.hS18iTT6AOqzVqLmHQu','0123456789','Company Doctor',1,1,0,1,1,1,1,-330,'2015-03-09 13:54:19','2015-03-09 13:54:19');
/*!40000 ALTER TABLE `users` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping routines for database 'planovik_main'
--
/*!50003 DROP PROCEDURE IF EXISTS `sp_createcurrconvcode` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_createcurrconvcode`(
	IN intocurr VARCHAR(3),
    IN infromcurr VARCHAR(3),
    IN inunitrate float,
    IN instatus SMALLINT(2),
    OUT result VARCHAR(30)
)
BEGIN

	DECLARE newconvcode INT(11);
    
    IF (Select count(*) from itin_currconv where fromcurr=infromcurr and tocurr=intocurr and unitrate=inunitrate = 1) THEN
		Select convcode INTO @newconvcode from itin_currconv where fromcurr=infromcurr and tocurr=intocurr and unitrate=inunitrate;
        SELECT CONCAT(@newconvcode, ' - ', infromcurr, ' to ', intocurr, '  Rate: ', inunitrate) INTO result;
    ELSE
		Insert into itin_currconv (fromcurr, tocurr, unitrate, status, datecreated, dateupdated) values (infromcurr,
        intocurr, inunitrate, instatus, UTC_TIMESTAMP(),  UTC_TIMESTAMP());
        SELECT LAST_INSERT_ID() INTO @newconvcode;
        SELECT CONCAT(@newconvcode, ' - ', infromcurr, ' to ', intocurr, '  Rate: ', inunitrate) INTO result;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_createeditmasteractnamedet` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_createeditmasteractnamedet`(
	IN	initinnum				INT(11),
    IN	inversion				SMALLINT(2),
    IN	inmasteractname			VARCHAR(45),
    IN	inmasteractstartdate 	DATETIME,
    IN	inmasteractenddate		DATETIME,
    IN 	inmasteractid			SMALLINT(3),
	OUT outmasteractid			VARCHAR(3)
)
BEGIN
	DECLARE actcnt			SMALLINT(3);
    DECLARE newmasteractid 	SMALLINT(3);
    
    
    IF (inmasteractid = 0) THEN

		Select count(*) INTO @actcnt from itin_activity_master_act where itinnum = initinnum and version = inversion;
		
		IF (@actcnt = 0) THEN
			Set @newmasteractid = 0;
		ELSE
			Select max(masteractid) into @newmasteractid from itin_activity_master_act where itinnum = initinnum and version = inversion;
		END IF;


		Insert into itin_activity_master_act (itinnum, masteractid, masteractname, masteractstartdate, masteractenddate,
		version, datecreated, dateupdated) Values (initinnum, @newmasteractid+1, inmasteractname, inmasteractstartdate, inmasteractenddate,
		inversion, UTC_TIMESTAMP(), UTC_TIMESTAMP());

		Select max(masteractid) into outmasteractid from itin_activity_master_act where itinnum = initinnum and version = inversion;


	ELSE
		Update itin_activity_master_act set masteractname=inmasteractname, masteractstartdate=inmasteractstartdate,
        masteractenddate=inmasteractenddate, dateupdated=UTC_TIMESTAMP() where itinnum=initinnum and
        masteractid=inmasteractid and version=inversion;
	
		Select inmasteractid into outmasteractid;
    END IF;
	

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_create_itinerary` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_create_itinerary`(
	IN name VARCHAR(50),
    IN version SMALLINT(2),
    IN status SMALLINT(2),
    IN currency VARCHAR(3),    
    IN quotecurrency VARCHAR(3),
    IN tzoffset SMALLINT,
    IN createdbyusername VARCHAR(30),
    OUT itinnum INT(11)
)
BEGIN
	DECLARE createdby INT(11);
    	
	Select id INTO @createdby from users where username=createdbyusername;
    
	INSERT INTO itin_master (id, name, version, status, tzoffset, currency, quotecurrency, createdby, datecreated, lastupdatedby, dateupdated) 
	VALUES (NULL, name, version, status, tzoffset, currency, quotecurrency, @createdby, UTC_TIMESTAMP(),  @createdby, UTC_TIMESTAMP());
	SELECT LAST_INSERT_ID() INTO itinnum;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_deletemasteract` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_deletemasteract`(
	IN	initinnum				INT(11),
    IN	inversion				SMALLINT(2),
    IN 	inmasteractid			SMALLINT(3)
)
BEGIN
		Delete from itin_activity_master_act where itinnum = initinnum and version = inversion and
        masteractid = inmasteractid;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_delete_activity` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_delete_activity`(
	IN		inactivityid	INT(11),
    IN		initinnum		INT(11),
    IN		intype			SMALLINT(2)
)
BEGIN
	IF (intype = 0) THEN
		Delete from itin_activity_travel where activityid = inactivityid and itinnum = initinnum;
    ELSEIF (intype = 1) THEN    
		Delete from itin_activity_hotel where activityid = inactivityid and itinnum = initinnum;
    ELSEIF (intype = 2) THEN    
		Delete from itin_activity_rental where activityid = inactivityid and itinnum = initinnum;
    ELSEIF (intype = 3) THEN    
		Delete from itin_activity_visit where activityid = inactivityid and itinnum = initinnum;
    ELSEIF (intype = 4) THEN    
		Delete from itin_activity_other where activityid = inactivityid and itinnum = initinnum;
        
    END IF;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_delete_user` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_delete_user`(
	IN inusername VARCHAR(100)
)
BEGIN

	update users set enabled=0, date_updated=UTC_TIMESTAMP() where username=inusername;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getactivitycodes` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getactivitycodes`(
	IN codetype VARCHAR (30)
)
BEGIN

	IF (codetype = '') THEN
		select CONCAT(code, ' - ', description) AS activitycodedesc from itin_activity_codes;
        
	ELSEIF (codetype = 'travel') THEN
		select CONCAT(code, ' - ', description) AS activitycodedesc from itin_activity_codes where LEFT(code,1)='T';

	ELSEIF (codetype = 'rental') THEN
		select CONCAT(code, ' - ', description) AS activitycodedesc from itin_activity_codes where LEFT(code,1)='R';

	ELSEIF (codetype = 'hotel') THEN
		select CONCAT(code, ' - ', description) AS activitycodedesc from itin_activity_codes where LEFT(code,1)='H';

	ELSEIF (codetype = 'visit') THEN
		select CONCAT(code, ' - ', description) AS activitycodedesc from itin_activity_codes where LEFT(code,1)='V';

	ELSEIF (codetype = 'other') THEN
		select CONCAT(code, ' - ', description) AS activitycodedesc from itin_activity_codes where LEFT(code,1)='O';
	
    END IF;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getconvcodedetails` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getconvcodedetails`(	
	IN currconvcode INT(11),
    OUT outfromcurr VARCHAR(3),
    OUT outtocurr	 VARCHAR(3),
    OUT outstatus   SMALLINT(2),
    OUT outunitrate FLOAT,
    OUT outdatecreated DATETIME,
    OUT outdateupdated DATETIME
)
BEGIN
	Select fromcurr, tocurr, status, unitrate, datecreated, dateupdated INTO outfromcurr, 
    outtocurr, outstatus, outunitrate, outdatecreated, outdateupdated from itin_currconv where convcode=currconvcode;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getcurrconvcodes` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getcurrconvcodes`(        
	IN  query	VARCHAR(30),
    IN	instatus SMALLINT(2)
)
BEGIN
		SELECT CONCAT(convcode, ' - ', fromcurr, ' to ', tocurr, '  Rate: ', unitrate) AS isocurrcodedesc FROM itin_currconv 
          WHERE fromcurr LIKE CONCAT("%", query, "%") and status=instatus order by convcode desc LIMIT 0, 20;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getidnamelist` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getidnamelist`(
        IN  query		               	VARCHAR(30)
)
BEGIN

SELECT CONCAT(name, ' ', orgid) AS orgidname FROM plnvk_org_seq WHERE name LIKE CONCAT("%", query, "%") LIMIT 0, 20;


END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getisocurrencydetails` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getisocurrencydetails`(
	IN inisocode VARCHAR(3),
    OUT outid INT(10),
    OUT outcurrdesc VARCHAR(20)
)
BEGIN
	Select id, currdesc into outid, outcurrdesc from isocurrencies where isocode=inisocode;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getisocurrlist` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getisocurrlist`(        
	IN  query	VARCHAR(30)
)
BEGIN
		SELECT CONCAT(isocode, ' - ', currdesc) AS isocurrcodedesc FROM isocurrencies WHERE isocode LIKE CONCAT("%", query, "%") order by currdesc LIMIT 0, 20;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getitinactivitycount` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getitinactivitycount`(
	IN  initinnum INT(11),
    IN  inversion INT(2)
)
BEGIN
	Select c.day, (select count(*) as cnt from itin_activity_master c2  where
		c2.itinnum = itinnum and c2.version=inversion and c2.day = c.day) as day from itin_activity_master c
		order by day asc;    
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getitinactivitymasterdet` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getitinactivitymasterdet`(
	IN  initinnum 				INT(11),
    IN  inversion 				INT(6),
    IN	ingroupnum 				SMALLINT(3),
    OUT outitinnum				INT(11),
    OUT	outversion				SMALLINT(2),
    OUT	outpax					SMALLINT(5),
    OUT	outgroupnum				SMALLINT(3),
    OUT outcountactivityhotel 	SMALLINT(3),
    OUT outcountactivityother	SMALLINT(3),
    OUT outcountactivityvisit	SMALLINT(3),
    OUT outcountactivitytravel	SMALLINT(3),
    OUT outcountactivityrental	SMALLINT(3)    
)
BEGIN
	Select itinnum, version, pax, groupnum, countactivityhotel, countactivityother, countactivityvisit, countactivitytravel, countactivityrental 
    INTO outitinnum, outversion, outpax, outgroupnum, outcountactivityhotel, outcountactivityother, outcountactivityvisit, outcountactivitytravel, outcountactivityrental
    from itin_activity_master where itinnum = initinnum and version = inversion and groupnum = ingroupnum;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getitinidnamelist` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getitinidnamelist`(
        IN  query		               	VARCHAR(30),
        IN 	isnumber					INT(1)
)
BEGIN
	DECLARE strnumber INT(11);      
        		       
	IF (isnumber = 1) THEN
		SET @strnumber := CONVERT(query, UNSIGNED);
		SELECT CONCAT(id, ' - ', name) AS itinnumbername FROM itin_master WHERE id LIKE CONCAT("%", @strnumber, "%") order by dateupdated desc LIMIT 0, 20;
	ELSE
		SELECT CONCAT(id, ' - ', name) AS itinnumbername FROM itin_master WHERE name LIKE CONCAT("%", query, "%") order by dateupdated desc LIMIT 0, 20;
        
        END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getmasteractivityactdet` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getmasteractivityactdet`(
	IN initinnum INT(11),
    IN inversion SMALLINT(2)
)
BEGIN
	SELECT  itinnum, masteractid, masteractname, masteractstartdate, masteractenddate, version, datecreated, dateupdated FROM itin_activity_master_act 
	  WHERE itinnum = initinnum and version = inversion order by masteractid;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getmasteractnamedet` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getmasteractnamedet`(
	IN initinnum INT(11),
    IN inmasteractid SMALLINT(3)
)
BEGIN
	Select itinnum, masteractid, masteractname, masteractstartdate, masteractenddate, datedcreated, dateupdated
    from itin_activity_master_act where itinnum = initinnum and masteractid = inmasteractid;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getorgdetails` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getorgdetails`(
        IN  orgid	VARCHAR(20)
)
BEGIN
    DECLARE tblnum VARCHAR(1);
    DECLARE tblname VARCHAR(15);
	DECLARE sqltext VARCHAR(300);
    DECLARE name VARCHAR(120);
    DECLARE shortname VARCHAR(120);
    DECLARE ip VARCHAR(45);
    DECLARE regcode VARCHAR(45);
    DECLARE regcodeissuingauthority VARCHAR(45);
    DECLARE isocountrycode VARCHAR(3);
    DECLARE logosealloc VARCHAR(200);
    DECLARE addrstreet1 VARCHAR(100);
    DECLARE addrstreet2 VARCHAR(100);
    DECLARE addrcitytown VARCHAR(60);
    DECLARE addrdistrict VARCHAR(60);
    DECLARE addrstateprovrgn VARCHAR(80);
    DECLARE addrpostalcode VARCHAR(20);
    DECLARE addrhomeurl VARCHAR(120);    
    DECLARE contacttitle VARCHAR(10);  
    DECLARE contactname VARCHAR(60);    
    DECLARE contactphoneoffice VARCHAR(20);    
    DECLARE contactphonemobile VARCHAR(20);    
    DECLARE contactemail VARCHAR(100);    
    DECLARE contactdesignation VARCHAR(45);
    DECLARE contactip VARCHAR(45);
    DECLARE type VARCHAR(20);
    DECLARE subtype VARCHAR(45);
    DECLARE status VARCHAR(15);
    DECLARE vrfreqcnt int(10);
    DECLARE vrfproccnt int(10);
    DECLARE alrtpendingcnt int(5);
    DECLARE msgsunrdcnt int(5);
    DECLARE accntbal decimal(10,2);
    DECLARE payoutbal decimal(10,2);
    DECLARE payoutdate datetime;
    DECLARE tzoffset smallint(6);
    DECLARE datecreated datetime;
    DECLARE dateupdated datetime;
    
	BEGIN
    
		SELECT SUBSTRING(orgid FROM (CHAR_LENGTH(orgid)) FOR 1) INTO @tblnum;
		SELECT CONCAT('plnvk_org_', @tblnum) INTO @tblname;

		SET @sqltext :=  CONCAT('select orgid, name, shortname, ip, regcode, regcodeissuingauthority, isocountrycode,
								logosealloc, addrstreet1, addrstreet2, addrcitytown, addrdistrict, addrstateprovrgn,
                                addrpostalcode, addrhomeurl, contacttitle, contactname, contactphoneoffice, contactphonemobile,
                                contactemail, contactdesignation, contactip, type, subtype, status, vrfreqcnt, vrfproccnt,
                                alrtpendingcnt, msgsunrdcnt, accntbal, payoutbal, payoutdate, tzoffset, datecreated, dateupdated
								from ', @tblname, ' where orgid=', '\'', orgid, '\'');
                
		PREPARE stmt FROM @sqltext;
		EXECUTE stmt;
		DEALLOCATE PREPARE stmt;                
	END;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getpasssalt` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getpasssalt`(
        IN  username	               	VARCHAR(20),
        OUT salt						VARCHAR(16),
        OUT pass						VARCHAR(20)
)
BEGIN
		select salt, pass INTO salt, pass from users where username = username;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getreportingmanagers` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getreportingmanagers`(
        IN  	inuserid INT(10)
)
BEGIN
	Select  username from users where id = (Select reportsto from users where id=inuserid) 
    UNION ALL
   	Select  username from users where id = (Select createdby from users where id=inuserid);

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_gettenantdetails` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_gettenantdetails`(
        IN  domainname	VARCHAR(20)
)
BEGIN
	Select id, type, status, subscription, domainname, dsurl, dsusername, dspassword, bkdsurl,
    bkdsusername, bkdspassword, datecreated, dateupdated from plnvk_tenant_master where domainname = domainname;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_getuserdetails` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_getuserdetails`(
        IN  	inusername VARCHAR(30)
)
BEGIN
    
	Select t1.id, t1.fullname, t1.password, t1.email, t1.username, t1.phone, t1.designation, t1.level, t1.enabled, t1.accountNonExpired,
    t1.accountNonLocked, t1.credentialsNonExpired, t1.tzoffset, t1.date_created, t1.date_updated, t2.role from 
    users t1, user_roles_map t2 where t1.username = inusername and t2.username= inusername;
    

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_get_activities_for_type` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_get_activities_for_type`(
	IN	itinnum	INT(11),
	IN	version	SMALLINT(2),
    IN  type SMALLINT(2)
)
BEGIN

	/* Based on type target the table*/
    IF (type = 0) THEN
		select a.activityid, a.itinnum, a.masteractid, a.actname, a.pax, a.mode, a.groupnum, a.code, a.version, a.vesselconame, a.vesselno,
		a.bookingclass, a.bookingno, a.depdatetime, a.arrdatetime, a.depstation, a.arrstation, a.cost, a.costmarkup, a.pikupdroplocfrom,
		a.pikupdroplocto, a.pikupdropdatetime, a.pikupdropcost, a.pikupdropcostmarkup, a.vehdetails, a.asstcost, a.asstcostmarkup,
		a.commentsinternal, a.commentsexternal, a.datecreated, a.dateupdated, a.lastupdatedby, a.createdby from itin_activity_travel a where a.itinnum = itinnum 
        and a.version = version order by a.activityid ASC;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_get_activity_details` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_get_activity_details`(
	IN	activityid	INT(11),
    IN  type SMALLINT(2)
)
BEGIN
	/* Based on type target the table*/
    IF (type = 0) THEN
		select a.activityid, a.itinnum, a.masteractid, a.actname, a.pax, a.mode, a.groupnum, a.code, a.version, a.vesselconame, a.vesselno,
		a.bookingclass, a.bookingno, a.depdatetime, a.arrdatetime, a.depstation, a.arrstation, a.cost, a.costmarkup, a.pikupdroplocfrom,
		a.pikupdroplocto, a.pikupdropdatetime, a.pikupdropcost, a.pikupdropcostmarkup, a.vehdetails, a.asstcost, a.asstcostmarkup,
		a.commentsinternal, a.commentsexternal, a.datecreated, a.dateupdated, a.lastupdatedby, a.createdby from itin_activity_travel a where a.activityid = activityid;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_get_admin_tasks` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_get_admin_tasks`()
BEGIN
	select a.id, a.subid, a.dateupdated AS lastupdate, CONCAT(b.name, ' ', a.orgid) AS orgidname, a.status,
	 a.code, a.assignedto AS assigned, a.remarks from plnvk_admin_tasks a INNER JOIN plnvk_org_seq b
	ON b.id = a.id where a.status=0 ORDER BY (a.id);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_get_itinerary` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_get_itinerary`(
	IN itinum INT(11)
)
BEGIN
    
	Select id, name, version, status, touroperator, grouphead, numtravellers, startdate, enddate, arrivalcity, depcity, 
	currency, quotecurrency, convcode, tzoffset, createdby, datecreated, lastupdatedby, dateupdated from itin_master where id=itinum;    
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_get_travel_activities` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_get_travel_activities`(
	IN	itinnum	INT(11),
	IN	version	SMALLINT(2)
)
BEGIN
	select a.activityid, a.itinnum, a.actname, a.pax, a.mode, a.groupnum, a.code, a.version, a.day, a.vesselconame, a.vesselno,
    a.bookingclass, a.bookingno, a.depdatetime, a.arrdatetime, a.depstation, a.arrstation, a.cost, a.costmarkup, a.pikupdroplocfrom,
    a.pikupdroplocto, a.pikupdropdatetime, a.pikupdropcost, a.pikupdropcostmarkup, a.vehdetails, a.asstcost, a.asstcostmarkup,
    a.commentsinternal, a.commentsexternal, a.datecreated, a.dateupdated, a.lastupdatedby, a.createdby from itin_activity_travel a where a.itinnum = itinnum
    and a.version = version order by a.day ASC, a.activityid ASC;
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_manageuser` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_manageuser`(
		IN	inemail						VARCHAR(120),
        IN  infullname		            VARCHAR(60), 
        IN  inpassword             		VARCHAR(60), 
        IN  inusername                	VARCHAR(30),
        IN	inrole						VARCHAR(25),
        IN  inphone			         	VARCHAR(20), 
        IN 	indesignation				VARCHAR(20),
        IN  reportstousername			VARCHAR(30),
        IN	createdbyusername			VARCHAR(30),
        IN  intzoffset					INT(6),
        IN  mode						VARCHAR(10),
        IN  inaccountNonLocked			SMALLINT(1),
        IN  incredentialsNonExpired		SMALLINT(1),
        OUT regerror					VARCHAR(160)
)
BEGIN

        DECLARE createdby INT(10);
        DECLARE reportsto INT(10);
        
		Select id INTO @createdby from users where username=createdbyusername;
		Select id INTO @reportsto from users where username=reportstousername;        
        		       
        IF (SELECT STRCMP(mode, 'Create') = 0) THEN
			BEGIN

				Insert INTO users ( email, fullname, username, password, phone, designation, reportsto, createdby, level,
                               tzoffset, date_created, date_updated
							) VALUES (inemail, infullname, inusername, inpassword, inphone, indesignation, @reportsto,
							   @createdby, 0, intzoffset, UTC_TIMESTAMP(), UTC_TIMESTAMP());
                
                Insert into user_roles_map set username=inusername, role=inrole, datecreated=UTC_TIMESTAMP(), dateupdated=UTC_TIMESTAMP();
            
            END;

        ELSEIF (SELECT STRCMP(mode, 'Edit') = 0) THEN

			UPDATE users SET fullname=infullname, email=inemail, phone=inphone, designation=indesignation, reportsto=@reportsto, 
							 accountNonLocked=inaccountNonLocked, credentialsNonExpired=incredentialsNonExpired, date_updated=UTC_TIMESTAMP where username=inusername;
			SELECT id into @userid from users where username=inusername;
            SELECT roleid into @roleid from user_roles where role=inrole;
			UPDATE user_roles_map SET role=inrole, datecreated=UTC_TIMESTAMP(), dateupdated=UTC_TIMESTAMP() where
				username=inusername;

        ELSEIF (SELECT STRCMP(mode, 'Disable') = 0) THEN
			
            UPDATE users SET enabled=0 where username=inusername;
        
        END IF;

END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_org_exists` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_org_exists`(
        IN  orgname		               	VARCHAR(120),
        OUT organizationid				VARCHAR(15)
)
BEGIN
		select orgid INTO organizationid from plnvk_org_seq where name = orgname;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_plnvk_org_insert` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_plnvk_org_insert`(
        IN  orgname		               	VARCHAR(120), 
        IN  contactip                  	VARCHAR(45), 
        IN  isocountrycode             	VARCHAR(3), 
        IN  contactname                	VARCHAR(60),
        IN  contactphoneoffice         	VARCHAR(20), 
        IN  contactphonemobile         	VARCHAR(20),
        IN	contactemail				VARCHAR(100),
        IN 	contactdesignation			VARCHAR(45),
        IN 	tzoffset					INT(6),
        OUT organizationid				VARCHAR(15),
        OUT regerror					VARCHAR(30)
     )
BEGIN
		DECLARE oid VARCHAR(15);
        DECLARE idtemp INT(8);
        DECLARE tname CHAR(9);
        DECLARE modval INT(1);
        DECLARE sqltext VARCHAR(300);
        DECLARE rowcount INT;

        
		SELECT `AUTO_INCREMENT` INTO @idtemp FROM INFORMATION_SCHEMA.TABLES
		WHERE TABLE_SCHEMA = 'plnvk_main' AND TABLE_NAME = 'plnvk_org_seq';
        COMMIT;
        
        SELECT @idtemp MOD 10 INTO @modval;
        COMMIT;
        
        SELECT CONCAT('plnvk_org_', @modval) INTO @tname;
        COMMIT;
        
        SELECT CONCAT('01-001-', LPAD(CAST(@idtemp AS CHAR),8,'0')) INTO @oid;
        COMMIT;
                
		SELECT orgid INTO @oid FROM vrf_org_seq where name=orgname;
		SELECT FOUND_ROWS() INTO @rowcount;
        
        IF (@rowcount > 0) THEN
		BEGIN
            set regerror := 'Duplicate Name';
			set organizationid := @oid;
        END;
        ELSE
        BEGIN
			SET @sqltext := concat(
							 'INSERT INTO ', @tname, ' (
							   orgid, 
							   name, 
							   contactip, 
							   isocountrycode, 
							   contactname, 
							   contactphoneoffice,
							   contactphonemobile,
							   contactemail,
							   contactdesignation,
							   tzoffset,
							   datecreated,
							   dateupdated
							) VALUES (',
							   '\'', @oid, '\'',',',
							   '\'', orgname, '\'',',',
							   '\'', contactip, '\'',',', 
							   '\'',isocountrycode, '\'',',', 
							   '\'',contactname, '\'',',',
							   '\'', contactphoneoffice, '\'',',',
							   '\'', contactphonemobile, '\'',',',
							   '\'', contactemail, '\'',',',
							   '\'',contactdesignation, '\'',',',
							   tzoffset,',',
							   '\'', UTC_TIMESTAMP(), '\'',',',
							   '\'', UTC_TIMESTAMP(), '\'',
							 ')');


			PREPARE stmt FROM @sqltext;
			EXECUTE stmt;
			DEALLOCATE PREPARE stmt;
			
			insert into plnvk_org_seq set id = @id, name=orgname, orgid=@oid;
            
            insert into plnvk_admin_tasks set subid=0, orgid=@oid, code=0, assignedto=1, status=0, 
            remarks='New org - requires verification', datecreated=UTC_TIMESTAMP(), dateupdated=UTC_TIMESTAMP();
		
		set organizationid := @oid;
		COMMIT;
		END;
        END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_save_itinerary` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_save_itinerary`(
	IN itinnum INT(11),
	IN name VARCHAR(50),
    IN mode VARCHAR(15),
    IN status VARCHAR(10),
    IN version SMALLINT(2),
    IN touroperator VARCHAR(30),
    IN grouphead VARCHAR(30),
    IN numtravellers SMALLINT,
    IN startdate DATETIME,
    IN enddate DATETIME,
    IN arrivalcity VARCHAR(30),
    IN depcity VARCHAR(30),
    IN quotecurrency VARCHAR(3),
    IN convcode INT(11),
    IN lastupdatedbyusername VARCHAR(30)
)
BEGIN
		DECLARE lastupdatedby INT(11);
        DECLARE activitymastercnt SMALLINT(2);
    	
		Select id INTO @lastupdatedby from users where username=lastupdatedbyusername;
		Select itinnum into @initinnum;
        
        update itin_master SET name=name, version=version, status=status, touroperator=touroperator, grouphead=grouphead, 
        numtravellers=numtravellers, startdate=startdate, enddate=enddate, arrivalcity=arrivalcity, 
        depcity=depcity, quotecurrency=quotecurrency, convcode=convcode, lastupdatedby=@lastupdatedby, dateupdated=UTC_TIMESTAMP()
        where id=itinnum;
        
        Select count(*) INTO @activitymastercnt from itin_activity_master where itinnum=itinnum and version=version;
        IF (@activitymastercnt = 0) THEN
			Insert INTO itin_activity_master (itinnum, version, pax, groupnum, datecreated, dateupdated, lastupdatedby, createdby)
            values (itinnum, version, numtravellers, 1, UTC_TIMESTAMP(), UTC_TIMESTAMP(), @lastupdatedby, @lastupdatedby);

			Insert INTO itin_activity_master_act (itinnum, masteractid, masteractname, masteractstartdate, masteractenddate,
			version, datecreated, dateupdated) Values (itinnum, 0, "Independent Activities", startdate, enddate,
			version, UTC_TIMESTAMP(), UTC_TIMESTAMP());

        ELSE
			Update itin_activity_master SET pax=numtravellers, groupnum=1, lastupdatedby=@lastupdatedby, dateupdated=UTC_TIMESTAMP();
        
		END IF;
        
    
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_save_travelactivity` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_save_travelactivity`(
    IN initinnum 				INT(11),
    IN inactname 				VARCHAR(45),
    IN lastupdatedbyemail 		VARCHAR(120),
    IN incode 					VARCHAR(10),
    IN inversion 				SMALLINT(2),
    IN inactivityid 			INT(11),
    IN inpax 					SMALLINT(5),
    IN inmode					SMALLINT(3),
    IN ingroupnum				SMALLINT(3),
    IN invesselno 				VARCHAR(15),
    IN invesselconame 			VARCHAR(20),
    IN inbookingno 				VARCHAR(10),
    IN inbookingclass 			VARCHAR(10),
    IN indepdatetime 			DATETIME,
    IN inarrdatetime 			DATETIME,
    IN inarrstation 			VARCHAR(30),
    IN indepstation 			VARCHAR(30),
    IN incost					DECIMAL(10,2),
    IN incostmarkup				SMALLINT(3),
    IN inasstcost				DECIMAL(10,2),
    IN inasstcostmarkup			SMALLINT(3),
    IN inpikupdroplocfrom		VARCHAR(30),
    IN inpikupdroplocto			VARCHAR(30),
    IN inpikupdropdatetime		DATETIME,
	IN invehdetails				VARCHAR(45),
    IN inpikupdropcost			DECIMAL(10,2),
    IN inpikupdropcostmarkup	SMALLINT(3),
	IN incommentsinternal		VARCHAR(100),
	IN incommentsexternal		VARCHAR(100),
    OUT outactivityid			INT(11)
)
BEGIN
		DECLARE lastupdatedby	INT(11);
        DECLARE activitycnt   	INT(5);
    	
		Select id INTO @lastupdatedby from users where username=lastupdatedbyemail;
		
        /* Check if brand new activity */
        Select count(*) into @activitycnt from itin_activity_master where itinnum=initinnum and version=inversion and groupnum=ingroupnum;
        
        IF (@activitycnt = 0) THEN

			Insert into itin_activity_master (itinnum, version, pax, groupnum, datecreated, dateupdated, countactivitytravel, createdby, lastupdatedby)
            values (initinnum, inversion, inpax, ingroupnum, UTC_TIMESTAMP(), UTC_TIMESTAMP(), 1, @lastupdatedby, @lastupdatedby);

			Insert into itin_activity_travel (actname, itinnum, pax, mode, groupnum, code, version, vesselconame, vesselno, bookingclass, bookingno, depdatetime,
            arrdatetime, depstation, arrstation, cost, costmarkup, pikupdroplocfrom, pikupdroplocto, pikupdropdatetime, pikupdropcost, pikupdropcostmarkup, vehdetails, asstcost, asstcostmarkup,
            commentsinternal, commentsexternal, datecreated, dateupdated, lastupdatedby, createdby) values (inactname, initinnum, inpax, inmode, ingroupnum, incode, inversion, invesselconame, invesselno,
            inbookingclass, inbookingno, indepdatetime, inarrdatetime, indepstation, inarrstation, incost, incostmarkup, inpikupdroplocfrom, inpikupdroplocto, inpikupdropdatetime, inpikupdropcost, inpikupdropcostmarkup,
            invehdetails, inasstcost, inasstcostmarkup, incommentsinternal,  incommentsexternal, UTC_TIMESTAMP(), UTC_TIMESTAMP(), @lastupdatedby,  @lastupdatedby);
        
			SELECT LAST_INSERT_ID() INTO outactivityid;

        ELSEIF (@activitycnt > 0) THEN
			Update itin_activity_master Set pax = inpax, countactivitytravel = countactivitytravel+1, lastupdatedby = @lastupdatedby, dateupdated = UTC_TIMESTAMP() where
            itinnum = initinnum and version = inversion and groupnum = ingroupnum;
            
            IF (inactivityid = 0) THEN
				Insert into itin_activity_travel (actname, itinnum, pax, mode, groupnum, code, version, vesselconame, vesselno, bookingclass, bookingno, depdatetime,
				arrdatetime, depstation, arrstation, cost, costmarkup, pikupdroplocfrom, pikupdroplocto, pikupdropdatetime, pikupdropcost, pikupdropcostmarkup, vehdetails, asstcost, asstcostmarkup,
				commentsinternal, commentsexternal, datecreated, dateupdated, lastupdatedby, createdby) values (inactname, initinnum, inpax, inmode, ingroupnum, incode, inversion, invesselconame, invesselno,
				inbookingclass, inbookingno, indepdatetime, inarrdatetime, indepstation, inarrstation, incost, incostmarkup, inpikupdroplocfrom, inpikupdroplocto, inpikupdropdatetime, inpikupdropcost, inpikupdropcostmarkup,
				invehdetails, inasstcost, inasstcostmarkup, incommentsinternal, incommentsexternal, UTC_TIMESTAMP(), UTC_TIMESTAMP(), @lastupdatedby,  @lastupdatedby);
				
                SELECT LAST_INSERT_ID() INTO outactivityid;

			ELSE
				Update itin_activity_travel Set actname=inactname, itinnum=initinnum, pax=inpax, mode=inmode, groupnum=ingroupnum, code=incode, version=inversion, 
                vesselconame=invesselconame, vesselno=invesselno, bookingclass=inbookingclass, bookingno=inbookingno, depdatetime=indepdatetime, arrdatetime=inarrdatetime,
                depstation=indepstation, arrstation=inarrstation, cost=incost, costmarkup=incostmarkup, pikupdroplocfrom=inpikupdroplocfrom, pikupdroplocto=inpikupdroplocto, pikupdropdatetime=inpikupdropdatetime, pikupdropcost=inpikupdropcost, pikupdropcostmarkup=inpikupdropcostmarkup,
                vehdetails=invehdetails, asstcost=inasstcost, asstcostmarkup=inasstcostmarkup, commentsinternal=incommentsinternal, commentsexternal=incommentsexternal, dateupdated=UTC_TIMESTAMP(), lastupdatedby=@lastupdatedby
                where activityid=inactivityid;
			
			END IF;
		END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_updateuser` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_updateuser`(
	IN 	inpass		VARCHAR(60),
    IN  inid		INT(10)
)
BEGIN
		update users set password=inpass, credentialsNonExpired=1, date_updated=UTC_TIMESTAMP() where id=inid;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `sp_user_exists` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8 */ ;
/*!50003 SET character_set_results = utf8 */ ;
/*!50003 SET collation_connection  = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_user_exists`(
        IN  inusername		               	VARCHAR(30),
        OUT userid							INT(10)
)
BEGIN
		select id into userid from users where username = inusername;
        IF (userid IS NULL) THEN
			SET userid = 0;
		END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2015-04-25 10:41:39
